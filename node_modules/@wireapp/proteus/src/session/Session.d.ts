import { Decoder, Encoder } from '@wireapp/cbor';
import { SessionState } from './SessionState';
import type { PreKeyStore } from './PreKeyStore';
import { SessionTag } from '../message/SessionTag';
import { IdentityKeyPair } from '../keys/IdentityKeyPair';
import { IdentityKey } from '../keys/IdentityKey';
import { PublicKey } from '../keys/PublicKey';
import { Envelope } from '../message/Envelope';
import { PreKeyBundle } from '../keys/PreKeyBundle';
export interface IntermediateSessionState {
    [index: string]: {
        idx: number;
        state: SessionState;
        tag: SessionTag;
    };
}
export declare class Session {
    static MAX_SESSION_STATES: number;
    readonly local_identity: IdentityKeyPair;
    readonly remote_identity: IdentityKey;
    readonly version: number;
    private counter;
    pending_prekey: [number, PublicKey] | null;
    session_states: IntermediateSessionState;
    session_tag: SessionTag;
    session_tag_name: string;
    constructor(localIdentity: IdentityKeyPair, remoteIdentity: IdentityKey, sessionTag?: SessionTag, pendingPrekey?: [number, PublicKey] | null, sessionStates?: IntermediateSessionState, version?: number);
    static init_from_prekey(local_identity: IdentityKeyPair, remote_pkbundle: PreKeyBundle): Session;
    static init_from_message(ourIdentity: IdentityKeyPair, prekey_store: PreKeyStore, envelope: Envelope): Promise<[Session, Uint8Array]>;
    private _new_state;
    private _insert_session_state;
    private _evict_oldest_session_state;
    get_local_identity(): IdentityKey;
    static encrypt(session: Session, plaintext: string | Uint8Array): Envelope;
    decrypt(prekey_store: PreKeyStore, envelope: Envelope): Promise<Uint8Array>;
    private _decrypt_prekey_message;
    private _decrypt_cipher_message;
    serialise(): ArrayBuffer;
    static deserialise(local_identity: IdentityKeyPair, buf: ArrayBuffer): Session;
    static encode(encoder: Encoder, session: Session): void;
    static decode(localIdentity: IdentityKeyPair, decoder: Decoder): Session;
}
